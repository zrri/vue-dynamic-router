(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-692ffa76"],{"05d0":function(e,t,s){"use strict";s("0a05")},"0a05":function(e,t,s){},4984:function(e,t,s){"use strict";s("d9be")},9406:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dashboard-container"},[s("div",{staticClass:"dashboard-text"},[e._v("name(用户权限等级):"+e._s(e.name))]),e._v(" "),s("div",{staticClass:"dashboard-text"},[e._v("roles(按钮级别权限):"+e._s(e.roles))]),e._v(" "),s("h2",[e._v("关于路由")]),e._v(" "),s("div",{staticClass:"dashboard-text"},[e._v("\n    权限标签"+e._s(e.name)+" 的路由为 "+e._s(e.showRouter)+"\n  ")]),e._v(" "),s("div",[e._v("未解析路由信息请看NetWork的,解析完成的路由信息请看控制台")]),e._v(" "),s("h2",[e._v("关于权限")]),e._v(" "),s("p",[e._v("这里做了简单的权限区分,")]),e._v(" "),s("p",[e._v('\n    admin 用户存在 "add", "delete", "edit", "view"\n    ,所以根据自定义指令管理员可以操作的按钮都会被渲染出来\n  ')]),e._v(" "),s("p",[e._v('\n    editor 用户只存在 "edit", "view" ,所以自定义指令/v-if不会渲染 增加 与 删除\n  ')]),e._v(" "),s("h3",[e._v("自定义指令的实现")]),e._v(" "),s("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"add",expression:"'add'"}],attrs:{type:"primary"}},[e._v("增加")]),e._v(" "),s("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"delete",expression:"'delete'"}],attrs:{type:"danger"}},[e._v("删除")]),e._v(" "),s("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"edit",expression:"'edit'"}],attrs:{type:"warning"}},[e._v("修改")]),e._v(" "),s("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"view",expression:"'view'"}],attrs:{type:"success"}},[e._v("查看")]),e._v(" "),s("h3",[e._v("v-if的实现")]),e._v(" "),e.basePermit("add")?s("el-button",{attrs:{type:"primary"}},[e._v("增加")]):e._e(),e._v(" "),e.basePermit("delete")?s("el-button",{attrs:{type:"danger"}},[e._v("删除")]):e._e(),e._v(" "),e.basePermit("edit")?s("el-button",{attrs:{type:"warning"}},[e._v("修改")]):e._e(),e._v(" "),e.basePermit("view")?s("el-button",{attrs:{type:"success"}},[e._v("查看")]):e._e(),e._v(" "),s("div",{staticClass:"toggle"},[s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.toggleShow}},[e._v("\n      代码思路\n    ")]),e._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.toggleUser}},[e._v("\n      切换用户\n    ")])],1),e._v(" "),s("user-show",{attrs:{show:e.show},on:{closeDialog:e.toggleShow}})],1)},n=[],r=(s("6762"),s("2fdb"),s("7f7f"),s("5530")),o=s("2f62"),a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"思路",visible:e.show,width:"800px","before-close":e.closeDialog},on:{"update:visible":function(t){e.show=t}}},[s("div",[s("h2",[e._v("\n      代码运行思路(已经登录,刷新页面的情况下)\n    ")]),e._v(" "),s("div",{staticClass:"item"},[s("div",[e._v("1. 在路由钩子里面判断是否首次进入系统(permission.js)")]),e._v(" "),s("div",[e._v("\n        2.\n        init为true说明已经获取过路由,就直接放行,init为false则向后台请求用户路由\n      ")]),e._v(" "),s("div",[e._v("3. 获取路由")]),e._v(" "),s("div",[e._v("4. 解析路由,存储权限")]),e._v(" "),s("div",[e._v("5. 使用router的api,addRouter拼接路由")]),e._v(" "),s("div",[e._v("6. 存储路由")]),e._v(" "),s("div",[e._v("7. init改为true,路由初始化完成")]),e._v(" "),s("div",[e._v("8. 放行路由")])])])])},v=[],d={props:{show:{type:Boolean,default:!1}},methods:{closeDialog:function(){this.$emit("closeDialog")}}},l=d,c=(s("4984"),s("2877")),u=Object(c["a"])(l,a,v,!1,null,"5ed9789f",null),_=u.exports,h={name:"Dashboard",components:{userShow:_},data:function(){return{show:!1}},computed:Object(r["a"])(Object(r["a"])({},Object(o["b"])(["name","roles"])),{},{showRouter:function(){return console.log("全部路由信息",this.$store.getters.routerList),this.$store.getters.routerList.length>0?this.$store.getters.routerList.reduce((function(e,t){return e.concat(t.path)}),[]):""}}),methods:{toggleUser:function(){var e=this;"Normal Editor"===this.name?this.$store.dispatch("user/login",{username:"admin",password:""}).then((function(){location.reload()})).catch((function(){e.$message("接口出现了一些问题....")})):"Super Admin"===this.name&&this.$store.dispatch("user/login",{username:"editor",password:""}).then((function(){location.reload()})).catch((function(){e.$message("接口出现了一些问题....")}))},basePermit:function(e){return this.$store.getters.roles.includes(e)},toggleShow:function(){this.show=!this.show}}},m=h,p=(s("05d0"),Object(c["a"])(m,i,n,!1,null,"224e3679",null));t["default"]=p.exports},d9be:function(e,t,s){}}]);